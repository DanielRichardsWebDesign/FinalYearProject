@model Project.Models.Projects
@using Microsoft.AspNet.Identity;

@{
    ViewBag.Title = "Details";
}

<h2>Details</h2>

<div>
    <h4>Projects</h4>

    @if (!Model.ProjectUsers.Any(p => p.ApplicationUserID == User.Identity.GetUserId()) && User.Identity.GetUserId() != null && !Model.ProjectUserRequests.Any(p => p.ApplicationUserID == User.Identity.GetUserId()))
    {
        <h2>Request project membership</h2>
        using (Html.BeginForm("RequestMembership", "ProjectUserRequests", FormMethod.Post, new { enctype = "multipart/form-data" }))
        {
            <input type="hidden" value="@Model.PublicID" name="projectID" />
            <input type="hidden" value="@User.Identity.GetUserId()" name="userID" />
            <input type="submit" class="btn btn-success" value="Submit Request" />
            <br />
        }

    }

    @if (Model.ProjectUserRequests.Any(p => p.ApplicationUserID == User.Identity.GetUserId()))
    {
        <h2>Your request has been sent and is currently being verified.</h2>
    }
    <hr />
    <dl class="dl-horizontal">
        <dt>
            Created By:
        </dt>

        <dd>
            @Html.DisplayFor(model => model.ApplicationUser.UserName)
        </dd>

        <dt>
            Project Name:
        </dt>

        <dd>
            @Html.DisplayFor(model => model.ProjectName)
        </dd>

        <dt>
            Project Type:
        </dt>

        <dd>
            @Html.DisplayFor(model => model.ProjectType)
        </dd>

        <dt>
            Description:
        </dt>

        <dd>
            @Html.DisplayFor(model => model.ProjectDescription)
        </dd>

        <dt>
            Date Created:
        </dt>

        <dd>
            @Html.DisplayFor(model => model.DateCreated)
        </dd>

    </dl>
</div>
<p>
    @if (Model.ApplicationUserID == User.Identity.GetUserId())
    {
        <a href="@Url.Action("Edit", "Projects", new { id = Model.PublicID })">
            Edit
            <span class="fas fa-wrench"></span>
        </a>
    }
    |
    <a href="@Url.Action("WorkStation", "Projects", new { id = Model.PublicID })" class="btn btn-primary">
        View Workstation
        <span class="fa fa-eye"></span>
    </a> |
    @if (Model.ApplicationUserID == User.Identity.GetUserId())
    {
        <a href="@Url.Action("Index", "Projects")">
            Back to List
            <span class="fas fa-undo"></span>
        </a>
    }
    |

</p>
